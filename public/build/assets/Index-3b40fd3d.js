import{f as b,m as O,g as T,q as B,o as n,h as E,w as s,b as o,d as c,a as e,c as d,i as S,F as D,s as U,x as Y,j as q,O as $,t as u,u as m,l as L}from"./app-02905ccf.js";import{_ as M}from"./AppLayout-875059f4.js";import{_ as y}from"./PrimaryButton-2219454a.js";import{_ as j}from"./ThePaginator-e6d891db.js";import{_ as z}from"./SearchComponent-9198517d.js";import{_ as G}from"./Checkbox-30b1dbdc.js";import{_ as H}from"./DialogModal-ac59735e.js";import{_ as J}from"./InputForm-2558843a.js";import{_ as K}from"./SecondaryButton-fc06f65f.js";import{C as _}from"./Carbon-053ffa43.js";import{T as Q}from"./TableSection-8132796f.js";import{_ as R}from"./UserInformation-158d51b0.js";import{u as W}from"./notify-f5ca9d60.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./helpers-3c1b81c1.js";import"./sweetalert2.all-1009aa37.js";const X={class:"w-full border-collapse bg-white text-left text-sm text-gray-500 mt-4"},Z=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",null,"Plan ID"),e("th",null,"Cliente"),e("th",null,"Finaliza")])],-1),ee={class:"divide-y divide-gray-100 border-t border-gray-100"},te={class:"flex items-center gap-4"},ae={class:"flex gap-2 items-center"},se=e("th",null,"Cliente",-1),oe=e("th",null,"Servicio",-1),re=e("th",null,"Expira",-1),ne=e("th",null,"Estado",-1),le=e("th",null,"Acciones",-1),de={class:"hover:bg-gray-50"},ie={class:"flex items-center gap-4"},ce=["tooltip"],ue={class:"flex items-center"},me={key:0,class:"badge-danger"},_e={key:1,class:"badge-success"},fe={key:0},he=e("td",{colspan:"7",class:"text-center"},"No data to display",-1),pe=[he],Oe={__name:"Index",props:{plans:{type:Object,required:!0}},setup(f){const g=f,p=b(!1),l=b(null),v=W(),i=b([]),C=_.today("Y-m-d"),h=O({search:"",type:"active"}),w=[{name:"Inicio",route:"dashboard.index"},{name:"Planes",route:"dashboard.plans.index"}];function P(a){h.search=a,A()}function A(){h.search===""&&delete h.search,$.get(route("dashboard.plans.index"),h,{preserveState:!0,preserveScroll:!0,only:["plans"],replace:!0})}function x(){i.value=g.plans.data.filter(a=>a.selected).map(function(a){return{id:a.id,customer:a.customer_name,end_date:a.end_date}})}const V=T(()=>g.plans.data.some(a=>a.selected));function N(){if(x(),i.value.length==0){v.error("Select at least one plan");return}p.value=!0}B(()=>l.value,a=>{x(),a&&i.value.forEach(r=>{r.end_date=_.create(r.end_date).addDays(parseInt(a)).format("Y-m-d")})});function F(){if(!l.value||l.value==0||l.value<1){v.error("Days must be greater than 0");return}$.put(route("dashboard.plans.extend"),i.value,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{k(),v.success("Days added successfully")}})}function k(){l.value=null,i.value=[],p.value=!1}return(a,r)=>(n(),E(M,{title:"Dashboard",breads:w},{default:s(()=>[o(H,{show:p.value},{title:s(()=>[c(" Agregar dias ")]),content:s(()=>[o(J,{text:"Dias",name:"days",modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=t=>l.value=t),type:"number"},null,8,["modelValue"]),e("table",X,[Z,e("tbody",ee,[(n(!0),d(D,null,S(i.value,t=>(n(),d("tr",null,[e("td",null,u(t.id),1),e("td",null,u(t.customer),1),e("td",null,u(m(_).create(t.end_date).format("d/m/Y")),1)]))),256))])])]),footer:s(()=>[o(K,{onClick:k},{default:s(()=>[c(" Cancelar ")]),_:1}),o(y,{type:"button",onClick:F},{default:s(()=>[c(" Guardar ")]),_:1})]),_:1},8,["show"]),o(Q,null,{topbar:s(()=>[e("div",te,[o(z,{onSearch:P})]),e("div",ae,[U(e("div",null,[o(y,{type:"button",onClick:r[1]||(r[1]=t=>N())},{default:s(()=>[c(" Agregar dias ")]),_:1})],512),[[Y,V.value]]),o(y,{type:"button",onClick:r[2]||(r[2]=t=>a.$inertia.visit(a.route("dashboard.customers.create")))},{default:s(()=>[c(" Nuevo ")]),_:1})])]),header:s(()=>[se,oe,re,ne,le]),body:s(()=>[(n(!0),d(D,null,S(f.plans.data,(t,ve)=>(n(),d("tr",de,[e("td",null,[e("div",ie,[o(G,{checked:t.selected,"onUpdate:checked":I=>t.selected=I,name:"status"},null,8,["checked","onUpdate:checked"]),o(R,{user:{name:t.customer_name}},null,8,["user"])])]),e("td",null,u(t.service_name)+" ("+u(t.period)+" dias) ",1),e("td",null,[e("span",{class:"badge-blue",tooltip:m(_).create(t.end_date+" 23:59:00").diffForHumans()},u(m(_).create(t.end_date).format("d de F")),9,ce)]),e("td",null,[e("div",ue,[t.end_date==m(C)?(n(),d("span",me," ULTIMO DIA! ")):(n(),d("span",_e," Activo "))])]),e("td",null,[o(m(L),{href:a.route("dashboard.customers.plans.create",t.customer_id),class:"badge-blue"},{default:s(()=>[c(" Pagar ")]),_:2},1032,["href"])])]))),256)),f.plans.data.length==0?(n(),d("tr",fe,pe)):q("",!0)]),paginator:s(()=>[o(j,{links:f.plans.links},null,8,["links"])]),_:1})]),_:1}))}};export{Oe as default};
