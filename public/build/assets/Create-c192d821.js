import{C as c,_ as A}from"./AppLayout-51991085.js";import{_ as S}from"./Checkbox-060615c0.js";import{_ as f}from"./InputForm-49fdbd83.js";import{_ as q}from"./SelectForm-16b2b8c2.js";import{_ as G}from"./FormSection-ff520a00.js";import{_ as I}from"./PrimaryButton-7a3ff8f5.js";import{_ as T}from"./SecondaryButton-f53e196a.js";import{p as E}from"./periodLabel-28cc2bc8.js";import{t as L}from"./toast-595fbe33.js";import{j as Y,T as O,p as b,m as B,o as m,f as z,w as l,a as t,b as n,d as _,t as d,u as s,c as v,k as D,F,h as R,n as W}from"./app-fe856dd9.js";import"./_plugin-vue_export-helper-c27b6911.js";const H=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Plan ",-1),J={class:"max-w-7xl mx-auto py-10 sm:px-6 lg:px-8"},K={class:"mt-3"},M={class:"uppercase"},Q={class:"uppercase"},X={class:"bg-white shadow-lg min-w-full text-xs font-mono py-4 px-3 text-gray-500"},Z=t("img",{src:"/img/logo-ag.png",alt:"",class:"w-14 h-14 mb-2 mx-auto"},null,-1),ee={class:"text-center mb-2"},te=t("div",{class:"text-center my-2"}," ------------------------- ",-1),ae=t("div",null,"RUC: 0000000",-1),se=t("div",null,"C4WC+G6V, León",-1),oe=t("div",null,"Tel: 2310-0000",-1),de=t("div",{class:"text-center my-2"}," ------------------------- ",-1),ie=t("div",{class:"text-center my-2"}," ------------------------- ",-1),re={class:"text-center font-bold"},ne=t("div",{class:"text-center my-2"}," ------------------------- ",-1),le=t("div",{class:"text-center text-xs"}," Gracias por su preferencia ",-1),ce={class:"grid grid-cols-2 gap-4"},ue=["value"],me=t("option",{value:"",selected:""},"Seleccionar periodo",-1),pe=["value"],_e={class:"grid grid-cols-2 gap-4"},ve={key:0,class:"mb-4"},fe={class:"mb-3 text-indigo-400"},xe={class:"block col-span-4 mb-4"},he={class:"col-span-4 text-lg font-medium text-gray-900"},Be={__name:"Create",props:{services:{type:Object,required:!1},plan:{type:Object,required:!1},customer:{type:Object,required:!0},isCurrentActive:{type:Boolean,required:!0}},setup(u){var C,y,V,$,k,U,w;const i=u,x=Y(!1),e=O({plan_id:(C=i.plan)==null?void 0:C.id,price:((y=i.plan)==null?void 0:y.price)??0,period:(V=i.plan)==null?void 0:V.period,start_date:i.isCurrentActive?c.create(i.plan.end_date).addDays(1).format():c.today(),end_date:($=i.plan)==null?void 0:$.end_date,discount:((k=i.plan)==null?void 0:k.discount)??0,note:((U=i.plan)==null?void 0:U.note)??"",service_id:((w=i.plan)==null?void 0:w.service_id)??i.services[0].id,save_note:!1}),N=[{name:"Inicio",route:"dashboard.index"},{name:"Clientes",route:"dashboard.customers.index"},{name:"Pagar",route:"dashboard.customers.plans.create",params:[i.customer.id]}],p=b(()=>{var r;return((r=i.services.find(o=>o.id==e.service_id))==null?void 0:r.prices)??[]}),h=b(()=>{var r;return e.period?((r=p.value.find(o=>o.period==e.period))==null?void 0:r.value)-e.discount:0});B(()=>e.service_id,()=>{p.value.find(r=>r.period==e.period)||(e.period=p.value[p.value.length-1].period)},{immediate:!0}),B(()=>x.value,r=>{r?e.start_date=c.create(i.plan.end_date).addDays(1).format():e.start_date=c.today()});const g=b(()=>c.create(e.start_date).addPeriod(parseInt(e.period)).addDays(-1).format());function P(){e.price=h.value,e.end_date=g.value,e.post(route("dashboard.customers.plans.store",i.customer.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{L.success("Guardado")}})}return(r,o)=>(m(),z(A,{title:"Customer",breads:N},{header:l(()=>[H]),default:l(()=>[t("div",J,[n(G,{onSubmitted:P},{title:l(()=>[_(" Informacion del plan ")]),description:l(()=>{var a;return[t("div",K,[_(" Cliente: "),t("span",M,d(i.customer.name),1)]),t("div",null,[_(" Estado del plan: "),t("span",Q,d(u.isCurrentActive?"Activo":"Expirado"),1)]),t("div",X,[Z,t("div",ee,[t("h1",null,d(r.$page.props.appName),1),te,ae,se,oe]),t("div",null,"Fecha: "+d(s(c).create().format("d/m/Y")),1),t("div",null," Cajero: "+d(r.$page.props.user.name),1),de,t("div",null,"Servicio: "+d((a=u.services.find(j=>s(e).service_id===j.id))==null?void 0:a.name),1),t("div",null,"Periodo: "+d(s(e).period)+" dia(s)",1),t("div",null," Inicio: "+d(s(c).create(s(e).start_date).format("d/m/Y")),1),t("div",null," Fin: "+d(s(c).create(s(e).end_date).format("d/m/Y")),1),t("div",null," Descuento: C$ "+d(s(e).discount),1),ie,t("div",re," Total: C$ "+d(h.value),1),ne,le])]}),form:l(()=>[t("div",ce,[n(q,{modelValue:s(e).service_id,"onUpdate:modelValue":o[0]||(o[0]=a=>s(e).service_id=a),text:"Servicio",required:"",name:"service_id"},{default:l(()=>[(m(!0),v(F,null,D(u.services,a=>(m(),v("option",{value:a.id},d(a.name),9,ue))),256))]),_:1},8,["modelValue"]),n(q,{modelValue:s(e).period,"onUpdate:modelValue":o[1]||(o[1]=a=>s(e).period=a),text:"Periodo",required:""},{default:l(()=>[me,(m(!0),v(F,null,D(p.value,a=>(m(),v("option",{value:a.period},d(s(E)[a.period])+" - C$ "+d(a.value),9,pe))),256))]),_:1},8,["modelValue"])]),t("div",_e,[n(f,{text:"Inicio del plan",modelValue:s(e).start_date,"onUpdate:modelValue":o[2]||(o[2]=a=>s(e).start_date=a),type:"date"},null,8,["modelValue"]),n(f,{text:"Fin del plan",modelValue:g.value,"onUpdate:modelValue":o[3]||(o[3]=a=>g.value=a),type:"date",disabled:""},null,8,["modelValue"])]),!u.isCurrentActive&&u.plan?(m(),v("div",ve,[t("div",fe," El plan anterior finalizó el "+d(s(c).create(u.plan.end_date).format("d/m/Y")),1),n(S,{checked:x.value,"onUpdate:checked":o[4]||(o[4]=a=>x.value=a),text:"Continuar el plan anterior",class:"col-span-4"},null,8,["checked"])])):R("",!0),n(f,{text:"Descuento C$ (Beca)",modelValue:s(e).discount,"onUpdate:modelValue":o[5]||(o[5]=a=>s(e).discount=a),type:"number"},null,8,["modelValue"]),n(f,{text:"Nota",modelValue:s(e).note,"onUpdate:modelValue":o[6]||(o[6]=a=>s(e).note=a)},null,8,["modelValue"]),t("div",xe,[n(S,{checked:s(e).save_note,"onUpdate:checked":o[7]||(o[7]=a=>s(e).save_note=a),text:"Guardar en notas"},null,8,["checked"])]),t("div",he," Total: C$ "+d(h.value),1)]),actions:l(()=>[n(T,{onClick:o[8]||(o[8]=a=>r.$inertia.visit(r.route("dashboard.customers.index")))},{default:l(()=>[_(" Cancelar ")]),_:1}),n(I,{class:W({"opacity-25":s(e).processing}),disabled:s(e).processing},{default:l(()=>[_(" Guardar ")]),_:1},8,["class","disabled"])]),_:1})])]),_:1}))}};export{Be as default};
