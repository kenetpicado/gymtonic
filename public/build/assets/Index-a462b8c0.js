import{h as b,m as T,j as I,p as B,o as n,b as E,w as s,d as r,f as c,a as e,c as d,k as D,F as S,s as U,x as Y,e as L,O as $,t as u,u as m,i as M}from"./app-2f343102.js";import{_ as j}from"./AppLayout-f9cfb8f2.js";import{_ as y}from"./PrimaryButton-d362a969.js";import{_ as q}from"./ThePaginator-1e2c8ab1.js";import{_ as z}from"./SearchComponent-15a69d16.js";import{_ as G}from"./Checkbox-105c907d.js";import{_ as H}from"./DialogModal-d07daf4a.js";import{_ as J}from"./InputForm-65091a83.js";import{_ as K}from"./SecondaryButton-a7552c42.js";import{C as _}from"./Carbon-053ffa43.js";import{T as Q}from"./TableSection-f60b7dab.js";import{_ as R}from"./UserInformation-13fecfbe.js";import{u as W}from"./notify-b4f88ed0.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./helpers-fbea5fba.js";import"./sweetalert2.all-4d206ebc.js";const X={class:"w-full border-collapse bg-white text-left text-sm text-gray-500 mt-4"},Z=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",null,"Plan ID"),e("th",null,"Cliente"),e("th",null,"Finaliza")])],-1),ee={class:"divide-y divide-gray-100 border-t border-gray-100"},te={class:"flex items-center gap-4"},ae={class:"flex gap-2 items-center"},se=e("th",null,"Cliente",-1),re=e("th",null,"Servicio",-1),oe=e("th",null,"Expira",-1),ne=e("th",null,"Estado",-1),le=e("th",null,"Acciones",-1),de={class:"hover:bg-gray-50"},ie={class:"flex items-center gap-4"},ce=["tooltip"],ue={class:"flex items-center"},me={key:0,class:"badge-danger"},_e={key:1,class:"badge-success"},fe={key:0},he=e("td",{colspan:"7",class:"text-center"},"No data to display",-1),pe=[he],Te={__name:"Index",props:{plans:{type:Object,required:!0}},setup(f){const g=f,p=b(!1),l=b(null),v=W(),i=b([]),C=_.today("Y-m-d"),h=T({search:"",type:"active"}),w=[{name:"Dashboard",route:"dashboard.index"},{name:"Planes",route:"dashboard.plans.index"}];function P(a){h.search=a,A()}function A(){h.search===""&&delete h.search,$.get(route("dashboard.plans.index"),h,{preserveState:!0,preserveScroll:!0,only:["plans"],replace:!0})}function k(){i.value=g.plans.data.filter(a=>a.selected).map(function(a){return{id:a.id,customer:a.customer_name,end_date:a.end_date}})}const V=I(()=>g.plans.data.some(a=>a.selected));function N(){if(k(),i.value.length==0){v.error("Select at least one plan");return}p.value=!0}B(()=>l.value,a=>{k(),a&&i.value.forEach(o=>{o.end_date=_.create(o.end_date).addDays(parseInt(a)).format("Y-m-d")})});function F(){if(!l.value||l.value==0||l.value<1){v.error("Days must be greater than 0");return}$.put(route("dashboard.plans.extend"),i.value,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{x(),v.success("Days added successfully")}})}function x(){l.value=null,i.value=[],p.value=!1}return(a,o)=>(n(),E(j,{title:"Dashboard",breads:w},{default:s(()=>[r(H,{show:p.value},{title:s(()=>[c(" Agregar dias ")]),content:s(()=>[r(J,{text:"Dias",name:"days",modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=t=>l.value=t),type:"number"},null,8,["modelValue"]),e("table",X,[Z,e("tbody",ee,[(n(!0),d(S,null,D(i.value,t=>(n(),d("tr",null,[e("td",null,u(t.id),1),e("td",null,u(t.customer),1),e("td",null,u(m(_).create(t.end_date).format("d/m/Y")),1)]))),256))])])]),footer:s(()=>[r(K,{onClick:x},{default:s(()=>[c(" Cancelar ")]),_:1}),r(y,{type:"button",onClick:F},{default:s(()=>[c(" Guardar ")]),_:1})]),_:1},8,["show"]),r(Q,null,{topbar:s(()=>[e("div",te,[r(z,{onSearch:P})]),e("div",ae,[U(e("div",null,[r(y,{type:"button",onClick:o[1]||(o[1]=t=>N())},{default:s(()=>[c(" Agregar dias ")]),_:1})],512),[[Y,V.value]]),r(y,{type:"button",onClick:o[2]||(o[2]=t=>a.$inertia.visit(a.route("dashboard.customers.create")))},{default:s(()=>[c(" Nuevo ")]),_:1})])]),header:s(()=>[se,re,oe,ne,le]),body:s(()=>[(n(!0),d(S,null,D(f.plans.data,(t,ve)=>(n(),d("tr",de,[e("td",null,[e("div",ie,[r(G,{checked:t.selected,"onUpdate:checked":O=>t.selected=O,name:"status"},null,8,["checked","onUpdate:checked"]),r(R,{user:{name:t.customer_name}},null,8,["user"])])]),e("td",null,u(t.service_name)+" ("+u(t.period)+" dias) ",1),e("td",null,[e("span",{class:"badge-blue",tooltip:m(_).create(t.end_date+" 23:59:00").diffForHumans()},u(m(_).create(t.end_date).format("d de F")),9,ce)]),e("td",null,[e("div",ue,[t.end_date==m(C)?(n(),d("span",me," ULTIMO DIA! ")):(n(),d("span",_e," Activo "))])]),e("td",null,[r(m(M),{href:a.route("dashboard.customers.plans.create",t.customer_id),class:"badge-blue"},{default:s(()=>[c(" Pagar ")]),_:2},1032,["href"])])]))),256)),f.plans.data.length==0?(n(),d("tr",fe,pe)):L("",!0)]),paginator:s(()=>[r(q,{links:f.plans.links},null,8,["links"])]),_:1})]),_:1}))}};export{Te as default};
