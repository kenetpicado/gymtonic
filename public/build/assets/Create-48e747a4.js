import{C as c,_ as F}from"./AppLayout-614eddf2.js";import{_ as P}from"./Checkbox-4805c14b.js";import{_ as x}from"./InputForm-b927c86e.js";import{_ as q}from"./SelectForm-ddf9ddad.js";import{_ as G}from"./FormSection-01ee759b.js";import{_ as I}from"./PrimaryButton-c9b80bfc.js";import{_ as T}from"./SecondaryButton-f490444e.js";import{p as E}from"./periodLabel-28cc2bc8.js";import{t as L}from"./toast-de30f96f.js";import{j as Y,T as O,p as C,m as B,o as p,f as z,w as l,a as t,b as n,d as _,t as d,u as s,c as v,k as D,F as N,h as H,n as R}from"./app-8985fe0f.js";import"./_plugin-vue_export-helper-c27b6911.js";const W=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Plan ",-1),J={class:"max-w-7xl mx-auto py-10 sm:px-6 lg:px-8"},K={class:"mt-3"},M={class:"uppercase"},Q={class:"uppercase"},X={class:"bg-white shadow-lg min-w-full text-xs font-mono py-4 px-3 text-gray-500"},Z=t("img",{src:"/img/logo-ag.png",alt:"",class:"w-14 h-14 mb-2 mx-auto"},null,-1),ee={class:"text-center mb-2"},te=t("div",{class:"text-center my-2"}," ------------------------- ",-1),ae=t("div",null,"RUC: 0000000",-1),se=t("div",null,"C4WC+G6V, León",-1),oe=t("div",null,"Tel: 2310-0000",-1),de={class:"mb-1"},ie={style:{"max-width":"10rem"}},re=t("div",{class:"text-center my-2"}," ------------------------- ",-1),ne=t("div",{class:"text-center my-2"}," ------------------------- ",-1),le={class:"text-center font-bold"},ce=t("div",{class:"text-center my-2"}," ------------------------- ",-1),ue=t("div",{class:"text-center text-xs"}," Gracias por su preferencia! ",-1),me={class:"grid grid-cols-2 gap-4"},pe=["value"],_e=t("option",{value:"",selected:""},"Seleccionar periodo",-1),ve=["value"],fe={class:"grid grid-cols-2 gap-4"},xe={key:0,class:"mb-4"},he={class:"mb-3 text-indigo-400"},be={class:"block col-span-4 mb-4"},ge={class:"col-span-4 text-lg font-medium text-gray-900"},De={__name:"Create",props:{services:{type:Object,required:!1},plan:{type:Object,required:!1},customer:{type:Object,required:!0},isCurrentActive:{type:Boolean,required:!0}},setup(u){var y,V,$,k,w,U,S;const i=u,h=Y(!1),e=O({plan_id:(y=i.plan)==null?void 0:y.id,price:((V=i.plan)==null?void 0:V.price)??0,period:($=i.plan)==null?void 0:$.period,start_date:i.isCurrentActive?c.create(i.plan.end_date).addDays(1).format():c.today(),end_date:(k=i.plan)==null?void 0:k.end_date,discount:((w=i.plan)==null?void 0:w.discount)??0,note:((U=i.plan)==null?void 0:U.note)??"",service_id:((S=i.plan)==null?void 0:S.service_id)??i.services[0].id,save_note:!1}),j=[{name:"Inicio",route:"dashboard.index"},{name:"Clientes",route:"dashboard.customers.index"},{name:"Pagar",route:"dashboard.customers.plans.create",params:[i.customer.id]}],m=C(()=>{var r;return((r=i.services.find(o=>o.id==e.service_id))==null?void 0:r.prices)??[]}),b=C(()=>{var r;return e.period?((r=m.value.find(o=>o.period==e.period))==null?void 0:r.value)-e.discount:0});B(()=>e.service_id,()=>{m.value.find(r=>r.period==e.period)||(e.period=m.value[m.value.length-1].period)},{immediate:!0}),B(()=>h.value,r=>{r?e.start_date=c.create(i.plan.end_date).addDays(1).format():e.start_date=c.today()});const f=C(()=>c.create(e.start_date).addPeriod(parseInt(e.period)).addDays(-1).format());function A(){e.price=b.value,e.end_date=f.value,e.post(route("dashboard.customers.plans.store",i.customer.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{L.success("Guardado")}})}return(r,o)=>(p(),z(F,{title:"Customer",breads:j},{header:l(()=>[W]),default:l(()=>[t("div",J,[n(G,{onSubmitted:A},{title:l(()=>[_(" Informacion del plan ")]),description:l(()=>{var a;return[t("div",K,[_(" Cliente: "),t("span",M,d(i.customer.name),1)]),t("div",null,[_(" Estado del plan: "),t("span",Q,d(u.isCurrentActive?"Activo":"Expirado"),1)]),t("div",X,[Z,t("div",ee,[t("h1",null,d(r.$page.props.appName),1),te,ae,se,oe]),t("div",de,d(s(c).create().format("d/m/Y H:i")),1),t("p",ie," Cajero: "+d(r.$page.props.user.name)+" amor mio ",1),re,t("div",null,"Servicio: "+d((a=u.services.find(g=>s(e).service_id===g.id))==null?void 0:a.name),1),t("div",null,"Periodo: "+d(s(e).period)+" dia(s)",1),t("div",null," Inicio: "+d(s(c).create(s(e).start_date).format("d/m/Y")),1),t("div",null," Fin: "+d(s(c).create(f.value).format("d/m/Y")),1),t("div",null," Precio: C$ "+d(m.value.find(g=>g.period==s(e).period).value),1),t("div",null," Descuento: C$ "+d(s(e).discount),1),ne,t("div",le," Total: C$ "+d(b.value),1),ce,ue])]}),form:l(()=>[t("div",me,[n(q,{modelValue:s(e).service_id,"onUpdate:modelValue":o[0]||(o[0]=a=>s(e).service_id=a),text:"Servicio",required:"",name:"service_id"},{default:l(()=>[(p(!0),v(N,null,D(u.services,a=>(p(),v("option",{value:a.id},d(a.name),9,pe))),256))]),_:1},8,["modelValue"]),n(q,{modelValue:s(e).period,"onUpdate:modelValue":o[1]||(o[1]=a=>s(e).period=a),text:"Periodo",required:""},{default:l(()=>[_e,(p(!0),v(N,null,D(m.value,a=>(p(),v("option",{value:a.period},d(s(E)[a.period])+" - C$ "+d(a.value),9,ve))),256))]),_:1},8,["modelValue"])]),t("div",fe,[n(x,{text:"Inicio del plan",modelValue:s(e).start_date,"onUpdate:modelValue":o[2]||(o[2]=a=>s(e).start_date=a),type:"date"},null,8,["modelValue"]),n(x,{text:"Fin del plan",modelValue:f.value,"onUpdate:modelValue":o[3]||(o[3]=a=>f.value=a),type:"date",disabled:""},null,8,["modelValue"])]),!u.isCurrentActive&&u.plan?(p(),v("div",xe,[t("div",he," El plan anterior finalizó el "+d(s(c).create(u.plan.end_date).format("d/m/Y")),1),n(P,{checked:h.value,"onUpdate:checked":o[4]||(o[4]=a=>h.value=a),text:"Continuar el plan anterior",class:"col-span-4"},null,8,["checked"])])):H("",!0),n(x,{text:"Descuento C$ (Beca)",modelValue:s(e).discount,"onUpdate:modelValue":o[5]||(o[5]=a=>s(e).discount=a),type:"number"},null,8,["modelValue"]),n(x,{text:"Nota",modelValue:s(e).note,"onUpdate:modelValue":o[6]||(o[6]=a=>s(e).note=a)},null,8,["modelValue"]),t("div",be,[n(P,{checked:s(e).save_note,"onUpdate:checked":o[7]||(o[7]=a=>s(e).save_note=a),text:"Guardar en notas"},null,8,["checked"])]),t("div",ge," Total: C$ "+d(b.value),1)]),actions:l(()=>[n(T,{onClick:o[8]||(o[8]=a=>r.$inertia.visit(r.route("dashboard.customers.index")))},{default:l(()=>[_(" Cancelar ")]),_:1}),n(I,{class:R({"opacity-25":s(e).processing}),disabled:s(e).processing},{default:l(()=>[_(" Guardar ")]),_:1},8,["class","disabled"])]),_:1})])]),_:1}))}};export{De as default};
